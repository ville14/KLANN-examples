[Code](https://github.com/ville14/KLANN)
[Paper]()

# Abstract

In recent years, neural network-based black-box modeling of nonlinear audio effects has improved considerably. Present convolutional and recurrent models can model audio effects with long-term dynamics, but the models require many parameters, thus increasing the processing time. In this paper, we propose KLANN, a Koopman-Linearised Audio Neural Network structure that lifts a one-dimensional signal (mono audio) into a high-dimensional approximately linear state-space representation with nonlinear mapping, and then uses differentiable biquad filters to predict linearly within the lifted state-space. Results show that the proposed models match the high performance of the state-of-the-art neural models while having a more compact architecture, reducing the number of parameters by tenfold, and having interpretable components.

# Audio examples

| | Face Bender | MCompressor | LA-2A |
| ------------- | ------------- | ------------- | ------------- |
| Input | <audio controls><source src="{{site.baseurl}}/facebender-example/facebender-rndamp-input.wav" type="audio/ogg"><source src="{{site.baseurl}}/facebender-example/facebender-rndamp-input.wav" type="audio/ogg">Your browser does not support the audio tag.</audio> | <audio controls><source src="{{site.baseurl}}/mcompressor-example/mcomp-rndamp-A1msR1000ms-input.wav" type="audio/ogg"><source src="{{site.baseurl}}/mcompressor-example/mcomp-rndamp-A1msR1000ms-input.wav" type="audio/ogg">Your browser does not support the audio tag.</audio> | <audio controls><source src="{{site.baseurl}}/la-2a-example/la2a-input.wav" type="audio/ogg"><source src="{{site.baseurl}}/la-2a-example/la2a-input.wav" type="audio/ogg">Your browser does not support the audio tag.</audio> |
| Target | <audio controls><source src="{{site.baseurl}}/facebender-example/facebender-rndamp-target.wav" type="audio/ogg"><source src="{{site.baseurl}}/facebender-example/facebender-rndamp-target.wav" type="audio/ogg">Your browser does not support the audio tag.</audio> | <audio controls><source src="{{site.baseurl}}/mcompressor-example/mcomp-rndamp-A1msR1000ms-target.wav" type="audio/ogg"><source src="{{site.baseurl}}/mcompressor-example/mcomp-rndamp-A1msR1000ms-target.wav" type="audio/ogg">Your browser does not support the audio tag.</audio> | <audio controls><source src="{{site.baseurl}}/la-2a-example/la2a-target.wav" type="audio/ogg"><source src="{{site.baseurl}}/la-2a-example/la2a-target.wav" type="audio/ogg">Your browser does not support the audio tag.</audio> | 
| small parallel KLANN | <audio controls><source src="{{site.baseurl}}/facebender-example/facebender-rndamp_small_MODEL1_hat.wav" type="audio/ogg"><source src="{{site.baseurl}}/facebender-example/facebender-rndamp_small_MODEL1_hat.wav.wav" type="audio/ogg">Your browser does not support the audio tag.</audio> | <audio controls><source src="{{site.baseurl}}/mcompressor-example/mcomp-rndamp-A1msR1000ms_small_MODEL1_hat.wav" type="audio/ogg"><source src="{{site.baseurl}}/mcompressor-example/mcomp-rndamp-A1msR1000ms_small_MODEL1_hat.wav" type="audio/ogg">Your browser does not support the audio tag.</audio> | <audio controls><source src="{{site.baseurl}}/la-2a-example/la2a_small_MODEL1_hat.wav" type="audio/ogg"><source src="{{site.baseurl}}/la-2a-example/la2a_small_MODEL1_hat.wav" type="audio/ogg">Your browser does not support the audio tag.</audio> |
| large parallel KLANN | <audio controls><source src="{{site.baseurl}}/facebender-example/facebender-rndamp_large_MODEL1_hat.wav" type="audio/ogg"><source src="{{site.baseurl}}/facebender-example/facebender-rndamp_large_MODEL1_hat.wav" type="audio/ogg">Your browser does not support the audio tag.</audio> | <audio controls><source src="{{site.baseurl}}/mcompressor-example/mcomp-rndamp-A1msR1000ms_large_MODEL1_hat.wav" type="audio/ogg"><source src="{{site.baseurl}}/mcompressor-example/mcomp-rndamp-A1msR1000ms_large_MODEL1_hat.wav" type="audio/ogg">Your browser does not support the audio tag.</audio> | <audio controls><source src="{{site.baseurl}}/la-2a-example/la2a_large_MODEL1_hat.wav" type="audio/ogg"><source src="{{site.baseurl}}/la-2a-example/la2a_large_MODEL1_hat.wav" type="audio/ogg">Your browser does not support the audio tag.</audio> |
| small parallel-series KLANN | <audio controls><source src="{{site.baseurl}}/facebender-example/facebender-rndamp_small_MODEL2_hat.wav" type="audio/ogg"><source src="{{site.baseurl}}/facebender-example/facebender-rndamp_small_MODEL2_hat.wav" type="audio/ogg">Your browser does not support the audio tag.</audio> | <audio controls><source src="{{site.baseurl}}/mcompressor-example/mcomp-rndamp-A1msR1000ms_small_MODEL2_hat.wav" type="audio/ogg"><source src="{{site.baseurl}}/mcompressor-example/mcomp-rndamp-A1msR1000ms_small_MODEL2_hat.wav" type="audio/ogg">Your browser does not support the audio tag.</audio> | <audio controls><source src="{{site.baseurl}}/la-2a-example/la2a_small_MODEL2_hat.wav" type="audio/ogg"><source src="{{site.baseurl}}/la-2a-example/la2a_small_MODEL2_hat.wav" type="audio/ogg">Your browser does not support the audio tag.</audio> |
| large parallel-series KLANN | <audio controls><source src="{{site.baseurl}}/facebender-example/facebender-rndamp_large_MODEL2_hat.wav" type="audio/ogg"><source src="{{site.baseurl}}/facebender-example/facebender-rndamp_large_MODEL2_hat.wav" type="audio/ogg">Your browser does not support the audio tag.</audio> | <audio controls><source src="{{site.baseurl}}/mcompressor-example/mcomp-rndamp-A1msR1000ms_large_MODEL2_hat.wav" type="audio/ogg"><source src="{{site.baseurl}}/mcompressor-example/mcomp-rndamp-A1msR1000ms_large_MODEL2_hat.wav" type="audio/ogg">Your browser does not support the audio tag.</audio> | <audio controls><source src="{{site.baseurl}}/la-2a-example/la2a_large_MODEL2_hat.wav" type="audio/ogg"><source src="{{site.baseurl}}/la-2a-example/la2a_large_MODEL2_hat.wav" type="audio/ogg">Your browser does not support the audio tag.</audio> |
| GCNTF-3 | <audio controls><source src="{{site.baseurl}}/facebender-example/facebender-rndamp_GCNTF3.wav" type="audio/ogg"><source src="{{site.baseurl}}/facebender-example/facebender-rndamp_GCNTF3.wav" type="audio/ogg">Your browser does not support the audio tag.</audio> |  | <audio controls><source src="{{site.baseurl}}/la-2a-example/la2a-GCNTF3.wav" type="audio/ogg"><source src="{{site.baseurl}}/la-2a-example/la2a-GCNTF3.wav" type="audio/ogg">Your browser does not support the audio tag.</audio> |
| GCNTF-2500 |  | <audio controls><source src="{{site.baseurl}}/mcompressor-example/mcomp-rndamp-A1msR1000ms_GCNTF2500.wav" type="audio/ogg"><source src="{{site.baseurl}}/mcompressor-example/mcomp-rndamp-A1msR1000ms_GCNTF2500.wav" type="audio/ogg">Your browser does not support the audio tag.</audio> |  |

# Impact of two-stage training
Audio samples of a small parallel-series model trained on the Face Bender. Stage I is the output after the first stage of training and stage II is the final output of the model.

| | Face Bender |
| ------------- | ------------- |
| Input | <audio controls><source src="{{site.baseurl}}/facebender-example/two-stage_training/facebender-rndamp-input.wav" type="audio/ogg"><source src="{{site.baseurl}}/facebender-example/two-stage_training/facebender-rndamp-input.wav" type="audio/ogg">Your browser does not support the audio tag.</audio> |
| Target | <audio controls><source src="{{site.baseurl}}/facebender-example/two-stage_training/facebender-rndamp-target.wav" type="audio/ogg"><source src="{{site.baseurl}}/facebender-example/two-stage_training/facebender-rndamp-target.wav" type="audio/ogg">Your browser does not support the audio tag.</audio> |
| Stage I | <audio controls><source src="{{site.baseurl}}/facebender-example/two-stage_training/facebender-rndamp_small_MODEL2_hat.wav" type="audio/ogg"><source src="{{site.baseurl}}/facebender-example/two-stage_training/facebender-rndamp_small_MODEL2_hat.wav" type="audio/ogg">Your browser does not support the audio tag.</audio> |
| Stage II | <audio controls><source src="{{site.baseurl}}/facebender-example/two-stage_training/facebender-rndamp_small_MODEL2_hat_before_MR_STFT.wav" type="audio/ogg"><source src="{{site.baseurl}}/facebender-example/two-stage_training/facebender-rndamp_small_MODEL2_hat_before_MR_STFT.wav" type="audio/ogg">Your browser does not support the audio tag.</audio> |
